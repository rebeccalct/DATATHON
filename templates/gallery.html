<!DOCTYPE html>
<html>
  <head>
    <title>Image Gallery</title>
  </head>
  <body>
    <h1>Image Gallery</h1>
    <form method="post">
      <label for="image">Select an image:</label>
      <select name="image" id="image">
        {% for file in input_files %}
          <option value="{{ file }}">{{ file }}</option>
        {% endfor %}
      </select>
      <button type="submit">Submit</button>
    </form>
    {% if selected_image %}
      <h2>Selected Image: {{ selected_image }}</h2>
      {% if sub_files %}
        <div id="image-gallery">
          {% for file in sub_files %}
            <img src="{{ url_for('static', filename='results/' + selected_image.split('.')[0] + '/' + file) }}">
          {% endfor %}
        </div>
      {% else %}
        <p>No images found for {{ selected_image }}</p>
      {% endif %}
    {% endif %}
    {% if error %}
      <p>Error: {{ error }}</p>
    {% endif %}
    <script>
      // Log any errors that occur when loading images
      var images = document.getElementsByTagName('img');
      for (var i = 0; i < images.length; i++) {
        images[i].addEventListener('error', function(event) {
          console.log('Error loading image:', event.target.src);
        });
      }
    </script>
  </body>
</html>
